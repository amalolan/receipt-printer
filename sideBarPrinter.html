<!DOCTYPE html>
<!-- Use this CSS stylesheet to ensure that add-ons styling 
     matches the default Google Docs styles -->
<link href="https://ssl.gstatic.com/docs/script/css/add-ons.css"
     rel="stylesheet"> 
     
<!-- The sidebar will have all the buttons -->
<div class="sidebar">     
  <div class="block form-group">
      <h3>
        <font face="Arial" color="6495ed"> Created by amalolan </font> 
      </h3> 
    <p>
      Carefully fill all these fields up without errors. Also, make sure you are on the sheet you want to print.<br />
      Link to a tutorial which contains the exact info about each input box: 
      <a href="https://docs.google.com/document/d/1n0K37hSGwkVaYo6iMhBdvBiNo2au_ghdci14LfqoUWM/edit?usp=sharing"> Tutorial </a> 
      <br /> <b> <font color="red"> WARNING: DO NOT refresh or close the page/tab. Wait until the sidebar automatically closes. </font> </b>
    </p>
    <p>Enter the cell with the amount</p>
    <input type="text" id="number" placeholder="Example: A1" />
    <br />
    <p>Enter the cell to write in words</p>
    <input type="text" id="amount" placeholder="Example: A1" />
    <br />
    <p>Enter the cell of the unique code</p>
    <input type="text" id="uid" placeholder="Example: A1" />
    <br />
    <p>Enter the last entry's Unique Code</p>
    <input type="number" id="final" placeholder="Enter final... " />
    <br />
    <p>Enter the destination path for the reciepts</p>
    <input type="text" id="path" placeholder="Ex: main/parent/child" />
    <br />
    <p>Enter the structure of the filename in the format: cell1,cell2,cell3 ... <br /> 
      The filename will be in the format: <br /> "cell1 cell2 cell3.. .pdf"</p>
    <input type="text" id="structure" placeholder="Ex: A1,A2,A3" />
    <br />
    <p>Once you're done, hit finish. The sidebar will close on its own when the script finishes. <br />
    <b> <font color="red">
      WARNING: DO NOT refresh or close the page/tab. Wait until the sidebar automatically closes.</font> </b>
    </p>
    <button class="blue" id="finish">Finish</button>
    <br />
  </div>
  <div id="output"></div>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js">
</script>

<script>  
function finish()
{
  // Initializes all the variables
  var number =  $("#number").val();
  var amount = $("#amount").val();
  var uid = $("#uid").val();
  var final = $('#final').val();
  var path = $('#path').val();
  var structure = $('#structure').val();
  // Now calls the function finished() with the parameters using google.script.run
  google.script.run.withSuccessHandler(function(input) {
    google.script.host.close();
  }).finished(number, amount, uid, final, path, structure);
}
// When clicked, it executes the function finish.
document.getElementById('finish').onclick = finish;

</script>

 
